title: 密码找回漏洞总结
date: 2015-08-07 16:58:06
tags: [findpassword]
---
概述
==
	大部分是乌云知识库中的内容，已经总结的很好了，再按照自己的思路过一遍。

1.伪造请求（未注册的情况下）
----------
	在请求密码修改的过程中，修改账号的手机或邮箱等联系方式，在接受到验证码后进行密码修改。
[OPPO修改任意帐号密码-2](http://www.wooyun.org/bugs/wooyun-2013-020425)
[OPPO修改任意帐号密码-3](http://www.wooyun.org/bugs/wooyun-2013-020532)
修改了接受密码手机，并且通过对账户类型的修改绕过边界。

2.使用正常账户请求修改获取token
----------

	 1. 爆破（绕过次数验证）
 [当当网任意用户密码修改漏洞](http://www.wooyun.org/bugs/wooyun-2012-011833)
 原因：验证码过于简单，并且没有对请求修改次数做出限制。
 [微信任意用户密码修改漏洞](http://www.wooyun.org/bugs/wooyun-2012-011720)
 原因：虽然设置了请求阀值，但被猜解除了验证方式，病找到了绕过方式，验证码为4-5位的数字容易爆破
 
	 2. 猜解
 [奇虎360任意密码修改](http://www.wooyun.org/bugs/wooyun-2012-08333)
 原因：使用了特定值的加密作为token，被猜解到使用了时间戳的MD5值。在实际过程中我们也可以尝试用户名，手机，邮箱，等等的不同加密方式。
 
	 3. 在客户端寻找token信息
 [走秀网秀团任意密码修改缺陷](http://www.wooyun.org/bugs/wooyun-2012-05630)
 原因：没有严格控制token，在返回的url中发现token信息
[ sohu邮箱任意用户密码重置](http://www.wooyun.org/bugs/wooyun-2012-04728)
原因：找回密码问题的答案在页面源码中可以看到...... 

3.通过验证提交修改请求时存在的漏洞
----------

	  在请求过程中修改用户uid
 [身份通任意密码修改-泄漏大量公民信息](http://www.wooyun.org/bugs/wooyun-2012-012572)
 [携程旅行网任意老板密码修改(庆在wooyun第100洞)](http://www.wooyun.org/bugs/wooyun-2013-018263)
 原因：没有管理好token和用户间一对一的关系，导致在最后提交请求的过程中修改了uid导致任意用户密码重置。

4.边界绕过特殊案例
----------
[网易邮箱可直接修改其用户密码](http://www.wooyun.org/bugs/wooyun-2012-08307) 
过程：注册过程的绑定手机页面用过参数修改，将任意账号绑定至可控手机，在通过密码找回流程找回


	以上资料均来自乌云知识库~